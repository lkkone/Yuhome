window.addEventListener("DOMContentLoaded", (function() {
    // 仅渲染自定义文字效果：不再请求任何外部版本信息
    const targetElement = document.querySelector(gilded_effect_Selector);
    // 文本来源：优先使用 gilded_effect；否则保留元素原文本
    const text = (typeof gilded_effect === "undefined" || !gilded_effect)
        ? (targetElement.textContent || "")
        : `${gilded_effect}`;
    
    if (!targetElement) {
        console.error(`Cannot find any element with selector "${gilded_effect_Selector}".`);
        return;
    }
    
    // 设置样式
    const style = typeof gilded_effect_Style !== "undefined" ? `${gilded_effect_Style}` : "0";
    let style_css = "";
    
    if (style === "1") {
        style_css = "-webkit-linear-gradient(left, #ff0000, #00ff00 25%, #0000ff 50%, #ff0000 75%, #00ff00)";
    } else if (style === "2") {
        style_css = "-webkit-linear-gradient(left, #ff00ff, #00ffff 25%, #ffff00 50%, #ff00ff 75%, #00ffff)";
    } else if (style === "3") {
        style_css = "-webkit-linear-gradient(left, #ff8000, #00ff80 25%, #8000ff 50%, #ff8000 75%, #00ff80)";
    } else {
        style_css = "-webkit-linear-gradient(left, #ffdd00, #3e2f08 25%, #ffdd00 50%, #3e2f08 75%, #ffdd00)";
    }
    
    // 设置字体大小
    if (typeof gilded_effect_FontSize === "undefined" || !gilded_effect_FontSize) {
        gilded_effect_FontSize = "20";
    }
    
    // 创建新元素并应用样式
    const versionElement = targetElement.cloneNode();
    versionElement.textContent = text;
    versionElement.style.fontWeight = "bold";
    versionElement.style.backgroundImage = style_css;
    versionElement.style.webkitTextFillColor = "transparent";
    versionElement.style.webkitBackgroundClip = "text";
    versionElement.style.webkitBackgroundSize = "200% 100%";
    versionElement.style.webkitAnimation = "maskedAnimation 3s infinite linear";
    versionElement.style.fontSize = gilded_effect_FontSize + "px";
    versionElement.style.width = `${text.length}ch`;
    
    // 替换原元素
    targetElement.parentNode.replaceChild(versionElement, targetElement);
    
    // 添加动画样式
    const styleElement = document.createElement("style");
    styleElement.textContent = `
    @keyframes maskedAnimation {
        0% {
            background-position: 0 0;
        }
        
        100% {
            background-position: -100% 0;
        }
    }`;
    document.head.appendChild(styleElement);
}));
